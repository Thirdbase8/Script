local player = game.Players.LocalPlayer
local replicatedStorage = game:GetService("ReplicatedStorage")

-- Function to add smelting objects for each tool in the Backpack
local function smeltTool(tool)
    -- Send the tool to the smelting system
    replicatedStorage:WaitForChild("Add_Smelting_Object"):FireServer(tool)
    print("Smelting " .. tool.Name)
end

-- Function to claim smelted objects
local function claimSmeltedObjects()
    local smeltingFolder = player:FindFirstChild("Smelting_Folder")

    if not smeltingFolder then
        warn("Smelting_Folder not found for player.")
        return
    end

    -- Iterate over all smelted items and claim them
    for _, target in ipairs(smeltingFolder:GetChildren()) do
        if target:IsA("NumberValue") then
            local id = target:FindFirstChild("ID")
            
            if id and id:IsA("NumberValue") then
                replicatedStorage:WaitForChild("Claim_Smelted_Object"):FireServer(target.Name, id.Value)
                print("Claimed " .. target.Name)
            else
                warn("No valid ID found for " .. target.Name)
            end
        end
    end
end

-- Function to cycle through and smelt all tools in the Backpack
local function smeltAllTools()
    local backpack = player:WaitForChild("Backpack")

    -- Iterate through each tool in the Backpack
    for _, tool in ipairs(backpack:GetChildren()) do
        if tool:IsA("Tool") then
            -- Smelt each tool individually
            smeltTool(tool)
            task.wait(1) -- Wait 1 second before smelting the next tool
        end
    end

    -- After all tools are smelted, claim the smelted objects
    task.wait(1) -- Wait for smelting to complete before claiming
    claimSmeltedObjects()
end

-- Execute the sequence to smelt and claim all tools
smeltAllTools()
